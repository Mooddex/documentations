````md
# Code Audit Summary: `useData` Composable

The following table documents the architectural and technical mistakes found in the provided code snippet as of **2026 standards**.

## Issues Overview

| Category | Issue | Description |
|--------|------|-------------|
| Fetch API | Missing JSON Stringify | In `addMovie` and `editMovie`, the body is passed as a raw object. Fetch requires `JSON.stringify(movie)` to send data correctly. |
| Fetch API | Missing Content-Type Header | Without headers `{ "Content-Type": "application/json" }`, most modern APIs will fail to parse the incoming POST/PUT request body. |
| Logic | Direct Response Pushing | In `addMovie`, `movies.value.push(res)` pushes a Fetch `Response` object, not the actual movie data. You must call `await res.json()` first. |
| Logic | Redundant Fetching | In `editMovie`, local state is updated and then `getMovies()` is called immediately, causing an unnecessary second network request. |
| TypeScript | Missing Exports | The functions `addMovie`, `deleteMovie`, and `editMovie` are defined but not returned, making them inaccessible to components. |
| Security | Base URL Handling | If `VITE_BASE_API` is missing or undefined, the fetch call will target `http://localhost:[port]/undefined`, a common silent failure. |
| Error Handling | Silent Failures | `getMovies` catches errors but does not update an error state. The UI may stay in a loading or empty state without feedback. |
| State Sync | Filter Mutation | In `deleteMovie`, local state is updated even if the server-side delete fails (e.g., server returns 500). |

## Suggested Fixes

### Headers
Always include headers for non-GET requests:
```js
headers: {
  "Content-Type": "application/json"
}
````

### Serialization

Wrap request payloads using:

```js
JSON.stringify(payload)
```

### Return Values

Ensure all composable functions are returned:

```js
return {
  movies,
  getMovies,
  addMovie,
  deleteMovie,
  editMovie,
  isEmpty,
  isLoading
};
```

### Response Handling

Always parse the response before mutating state:

```js
const data = await res.json();
movies.value.push(data);
```

```
```
